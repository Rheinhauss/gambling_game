# 系统需求文档

## 1. 项目可行性分析与描述

### 1.1 软件领域

**问题归属领域：** 游戏开发领域

**领域边界：** 《恶魔轮盘》是一款网页卡牌作战游戏，主要涉及卡牌游戏设计、策略游戏开发以及在线对战游戏领域。其边界主要包括游戏机制设计、用户界面设计、游戏平衡性调整等方面。

### 1.2 面向用户

**目标用户：** 游戏爱好者、策略游戏玩家、卡牌游戏爱好者等。

**用户需求：**

1. 寻找一款有趣、具有挑战性的策略游戏。

2. 喜欢进行在线对战，与其他玩家展开竞技。

3. 希望通过思考和决策来制定策略，战胜对手。

4. 对于卡牌收集、卡组构建和游戏平衡性有一定的关注和需求。

### 1.3 竞品分析

**现有竞品：**

1. 《恶魔轮盘》原版游戏（Steam版）

2. 其他类似的卡牌作战游戏

**竞品优势：**

《恶魔轮盘》原版游戏（Steam版）：

1. 具有一定的用户基础和市场认知度。

2. 提供了丰富的游戏内容和深度的游戏体验。

3. 有更为完善和复杂的游戏机制和系统。

其他类似的卡牌作战游戏：

1. 可能拥有不同的卡牌套组和作战方式，游戏机制上更有深度。

2. 具有对特定用户的吸引力。

**竞品劣势：**

《恶魔轮盘》原版游戏（Steam版）：

1. 只能单机游玩，缺乏与其他玩家进行对战的功能。

2. 需要下载安装包，占用存储空间，可能增加用户的使用成本和门槛。

3. 对于一些玩家而言，可能过于复杂或耗时。

其他类似的卡牌作战游戏：

1. 可能存在游戏平衡性问题或玩法单一的情况。

2. 对于新玩家的吸引力可能不如创新的游戏。

3. 可能缺乏一些新颖的游戏元素或创新的玩法。

**《恶魔轮盘》网页游戏的优势：**

1. **联机对战：** 与原版游戏相比，《恶魔轮盘》网页游戏允许玩家通过网络与其他玩家进行对战，增加了游戏的社交互动性和竞技性。

2. **轻量化无需下载：** 与原版游戏相比，《恶魔轮盘》网页游戏无需下载安装包，玩家可以直接通过浏览器访问并进行游戏，节省了下载和安装的时间和空间成本，提高了游戏的便捷性和易用性。

3. **跨平台兼容性：** 由于是基于网页的游戏，可以在各种设备上进行游戏，包括PC、平板电脑和手机等，无需受到特定操作系统或设备的限制，提高了游戏的灵活性和可访问性。

通过以上分析，本产品《恶魔轮盘》网页游戏具有一定的市场潜力和竞争优势，能够吸引到一定数量的目标用户，并满足他们的游戏需求。

## 2. 系统功能清单及依赖性分析

要求详细地展示出软件系统所实现的具体功能。
	绘制功能分解的层次图（即功能分解的“树”图，树中的每个节点为一个功能，大功能对应于树的中间节点，大功能所包容的小功能是它的子树或子节点。）
	采用UML用例图展示用户类型及存取权限分配方案
	明确客户端应用与服务端应用各自实现哪些功能。
	附上软件运行截图，每张图再配上说明文字，展示重要功能的UI界面与交互设计方案

### 2.1 软件功能层次图

从界面逻辑上，软件功能层次如下所示：

![game functions](https://img.z4a.net/images/2024/06/09/game_functions.png)

其中，客户端负责显示信息和玩家交互，服务端负责具体的游戏逻辑和维护游戏中涉及的数据。

### 2.2 用户类型及权限方案

目前的游戏项目中，用户不需要登录或注册即可访问应用，以不同的连接方式来区分用户。

游客用户是指未经身份验证的应用访问者，他们可以通过websocket连接访问游戏应用，但不需要提供任何身份验证信息。游客用户可以参与游戏并执行游戏规则允许的操作，如创建房间、加入房间、离开房间、进行游戏等，这些操作已经涵盖了本项目的功能。

### 2.3 功能分配

#### 2.3.1 客户端功能

1. **游戏界面显示与跳转：**

   显示游戏主界面，包括开始界面、匹配界面、游戏界面和结束界面。

   处理用户点击事件，实现界面之间的跳转，如从开始界面跳转到匹配界面，从匹配界面跳转到游戏界面等。

2. **处理玩家输入：**

   捕获玩家的点击事件，响应按钮的点击操作。

   接收玩家输入的文本内容，如房间号等。

3. **响应玩家行为：**

   根据玩家点击不同的按钮，执行相应的功能，如创建房间、退出房间、开始游戏、出牌、开枪等。

   根据玩家输入的文本内容，执行相应的操作，如加入特定房间等。

4. **更新界面元素：**

   根据游戏进行的状态更新界面中的元素，如玩家信息、游戏进度等。

   根据玩家操作或游戏事件，更新界面中的卡牌、道具、房间列表等内容。

5. **信息显示与提示：**

   使用弹窗或消息框显示游戏进行中产生的信息，如游戏状态变化、胜利失败提示、对手操作等。

   提供用户友好的界面提示，引导玩家操作或解释游戏规则。

#### 2.3.2 服务端应用功能清单

1. **游戏逻辑处理：**

   管理游戏房间和玩家状态，包括玩家加入、退出、准备等操作。

   处理游戏中的逻辑事件，如卡牌的抽取、使用卡牌、战斗计算等。

2. **游戏数据管理：**

   维护游戏的数据结构，如玩家信息、房间信息、卡牌数据等。

   提供数据查询和更新的接口，以供客户端应用调用。

3. **网络通信：**

   处理客户端应用发送过来的网络请求，如创建房间、加入房间、退出房间、开始游戏等。

   向客户端应用发送游戏状态变化等信息，实现实时通信和同步。

4. **游戏状态管理：**

   管理游戏的状态机制，包括游戏开始、进行中、结束等状态的转换。

   根据玩家操作或游戏事件，更新游戏状态并通知客户端应用。

5. **安全性与稳定性：**

   保障游戏服务器的稳定运行，处理异常情况和错误。

### 2.4 UI界面与交互设计

#### 2.4.1 UI设计草图

考虑用户在界面上的操作流程，确保界面元素的交互设计符合直觉，并且能够让玩家轻松地进行游戏操作，我们为游戏界面设计了大致的草图，部分草图如下。

![1](https://img.z4a.net/images/2024/06/09/1.png)

![4](https://img.z4a.net/images/2024/06/09/4.png)

#### 2.4.2 软件截图与交互设计

软件分为四个界面，分别是开始界面，匹配界面，游戏界面和结束界面。

##### 2.4.2.1 开始界面

开始界面中央显示游戏标题“恶魔轮盘”，下方是两个纵向排列的按钮，分别是“在线游戏”和“退出”，点击“在线游戏”，会跳转到匹配界面，点击“退出”，会关闭当前界面跳转到空白页。

![start page](https://img.z4a.net/images/2024/06/09/start_page.png)

##### 2.4.2.2 匹配界面

匹配界面中，玩家可以选择自己创建房间，或加入好友创建好的房间。创建房间后可以将房间号分享给游戏好友。

匹配界面中显示一个文本框，文本框中需要玩家输入想加入的好友的房间号。下方横向并列三个按钮“创建房间”“加入房间”“离开房间”，最下面的按钮是“返回开始界面”，点击后则跳转到开始界面。

初始状态时，离开房间状态不可用，加入了某个房间后，创建房间和加入房间都将不可用，离开房间状态变为可用。

![match page](https://img.z4a.net/images/2024/06/09/match_page.png)

当文本框为空时，点击加入房间按钮，提示“请在输入框中输入房间ID再加入房间！”

加入房间时，提示“正在加入房间……”

![add room](https://img.z4a.net/images/2024/06/09/add_room.png)

加入房间成功后，提示“加入房间成功，即将开始游戏！”，并跳转到游戏界面。

![add room success](https://img.z4a.net/images/2024/06/09/add_room_success.png)

加入房间失败后，提示“加入房间失败，即将开始游戏！”

创建房间并成功时，提示“房间创建成功！房间号为：”，后面显示创建的房间号。

创建房间并失败时，提示“创建房间失败，请重试！”

对手加入房间时，提示“对手加入房间，即将开始游戏！”，并跳转到游戏界面。

对手离开房间时，提示“对手离开房间！”

##### 2.4.2.3 游戏界面

游戏界面由五个部分组成，首先，将界面分为左右两半区域。左边的区域上方部分显示对手头像对手的手牌栏，中间部分显示枪的图片按钮，下方部分显示玩家头像和玩家的手牌区域。右半区域上方显示状态栏，下方显示出牌按钮。

![game button hover](https://img.z4a.net/images/2024/06/09/game_button_hover.png)

**头像：**对手头像、玩家头像以图形形式呈现，以简化界面，并且不允许玩家与其进行交互。

**枪：**：点击枪的按钮，跳出窗口，窗口中上面有一行文字“请选择开枪的对象：”有两个按钮，上下排列，第一个按钮是“对手”，点击后触发向对手开枪的逻辑，第二个按钮是“自己”，点击后触发向自己开枪的逻辑。点击了任何一个按钮后，这个小的窗口将会消失。开枪窗口跳出时，将无法选择手牌，也无法出牌。

![game shoot](https://img.z4a.net/images/2024/06/09/game_shoot.png)

**玩家手牌栏：**：手牌栏最大栏位为4，将根据手牌数量将手牌渲染到栏位中，无手牌的栏位不进行渲染。可以点击手牌，此时手牌变为选中模式，手牌周围出现红色加粗线框，再点击一遍已选中的手牌或者点击其他手牌，手牌的选中模式会取消，红色加粗线框消失。每次只能选中1张手牌，在已选中手牌的情况下点击出牌按钮，可以出牌，否则出牌按钮将不可用。鼠标悬浮在手牌上时，会在鼠标附近显示卡牌的效果文本框。

**对手手牌栏：**玩家只能看到对方持有的手牌和手牌的变化情况，无法与之交互。

**状态栏：** 游戏将持续进行，直到其中一方玩家的血量降至0。在游戏进行状态下，界面应展示以下信息：

​	玩家血量：显示玩家当前的血量值。

​	对手血量：显示对手当前的血量值。

**出牌按钮：**玩家只有在自己的回合并选中了手牌的情况下才能出牌，否则出牌按钮将不可用。

相比草图设计，我们简化了游戏界面的按钮设计，取消了拿枪按钮，改为点击枪的图片按钮，美化了具体的布局。

每轮游戏开始时，屏幕上会显示轮次信息窗口，包括轮次数目，枪中的子弹数，其中有多少颗实弹和多少颗哑弹。这个窗口将在显示2秒后消失。之后游戏进行过程中，提示双方行为的窗口均为显示2秒后消失，行为包括使用道具的效果，开枪的效果等。

![game round start](https://img.z4a.net/images/2024/06/09/game_round_start.png)

每回合开始时，玩家可以抽取道具卡牌，此时在界面上会出现一个窗口，上面写着“请在下方列表中抽取一个道具”，该窗口中初始化三个按钮，每个按钮显示为一张图片，分别是服务端传来的道具名称对应的道具图片。当点击其中一个按钮时，对应的图片按钮边框加粗并变为红色， 点击其他的按钮，则这种边框加粗并变红的效果消失。如果在选中再次点击相同的按钮，则视为抽取这个按钮对应的卡牌，抽牌窗口消失，抽取的卡牌将在更新双方手牌列表后显示在手牌栏中。在此时将鼠标悬浮在卡牌按钮上，也可以显示对应的卡牌效果信息，此时下方手牌按钮将不可用。

![draw card](https://img.z4a.net/images/2024/06/09/draw_card.png)

按照相应逻辑出牌后，屏幕上会显示使用人，使用的卡牌信息和卡牌效果。

![card use](https://img.z4a.net/images/2024/06/09/card_use.png)

![oppo use item](https://img.z4a.net/images/2024/06/09/oppo_use_item.png)

当一方生命值为0时，结束游戏，并跳转到结束界面。

##### 2.4.2.4 结束界面

结束界面会显示玩家的输赢情况和回合数。

界面下方显示两个按钮，一个是是“返回开始界面”，点击后则跳转到开始界面。另一个是“退出”，点击后，会关闭当前界面跳转到空白页。

![end game](https://img.z4a.net/images/2024/06/09/end_game.png)

## 3. 领域对象模型

绘制UML类图展示系统中与业务相关的主要类以及类之间的协作关系（组合、继承、依赖……）；

绘制包图来展示系统总体结构（所有的类都必须归属于某个包，特定包拥有特定的职责，各个包之间功能不能有重合的情况）

### 3.1 类与类间关系

### 3.2 系统总体结构

## 4. 系统动态特性

可抽取若干个系统用例，使用活动图、顺序图、状态机图等UML标准图展示系统动态特性，比如数据处理流程，对象之间的合作关系等。

### 4.1 数据处理流程

### 4.2 游戏逻辑状态机

